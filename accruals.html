<h2>Начисления</h2>
<h4>Отчет показывает начисления по периодам за текущий год</h4>
<br>
<% if (getMonthlyAccruals().length !== 0) { %>
<% let totalAccrued = 0; %>
<% let totalNdfl = 0; %>
<% let totalTotal = 0; %>

<% let currentPeriod = ""; %>

<% for (const detail of getMonthlyAccruals()) { %>
<% if (currentPeriod !== detail.period) { %>
<% currentPeriod = detail.period; %>

<h3><%= currentPeriod %></h3>
<table class="sl-table">
    <tr class="sl-table__head">
        <th class="sl-table__head-cell">Специализация</th>
        <th class="sl-table__head-cell">Заказчик / Проект</th>
        <th class="sl-table__head-cell">Задача</th>
        <th class="sl-table__head-cell">Задание</th>
        <th class="sl-table__head-cell">Роль</th>
        <th class="sl-table__head-cell">Начислено</th>
        <th class="sl-table__head-cell">Налог</th>
        <th class="sl-table__head-cell">На руки</th>
    </tr>
    <% } %>

    <tr class="sl-table__line">
        <td class="sl-table__line-cell"><%= detail.specialization %></td>
        <td class="sl-table__line-cell"><%= detail.client_project %></td>
        <td class="sl-table__line-cell"><%= detail.projectTask %></td>
        <td class="sl-table__line-cell"><%= detail.task %></td>
        <td class="sl-table__line-cell"><%= detail.role %></td>
        <td class="sl-table__line-cell"><%= detail.accrued %></td>
        <td class="sl-table__line-cell"><%= detail.ndfl %></td>
        <td class="sl-table__line-cell"><%= detail.total %></td>
    </tr>

    <% totalAccrued += detail.accrued %>
    <% totalNdfl += detail.ndfl %>
    <% totalTotal += detail.total %>
    <% if (detail === getMonthlyAccruals()[getMonthlyAccruals().length - 1] || currentPeriod !== getMonthlyAccruals()[getMonthlyAccruals().indexOf(detail) + 1].period) { %>
    <tr class="sl-table__total">
        <td class="sl-table__total-cell">Итого</td>
        <td class="sl-table__total-cell"></td>
        <td class="sl-table__total-cell"></td>
        <td class="sl-table__total-cell"></td>
        <td class="sl-table__total-cell"></td>
        <td class="sl-table__total-cell"><%= totalAccrued.toFixed(2) %></td>
        <td class="sl-table__total-cell"><%= totalNdfl.toFixed(2) %></td>
        <td class="sl-table__total-cell"><%= totalTotal.toFixed(2) %></td>
    </tr>
</table>
<br>
<% } %>
<% } %>
<% } else { %>
<p>Данные отсутствуют</p>
<% } %>
